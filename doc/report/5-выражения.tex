\hypertarget{expressions}{%
\section{Выражения}\label{expr:chapter}}

Выражение определяет вычисление значения путем применения операторов и функций к операндам. 

\begin{Grammar}
Выражение
    : Унарное-выражение
	| Выражение Бинарная-операция Выражение

Унарное-выражение
	: Первичное-выражение
	| Унарная-операция Унарное-выражение
\end{Grammar}    

\hypertarget{primary-expr}{%
\subsection{Первичные выражения}\label{expr:primary-expr}}

Первичные выражения - это выражения, которые являются операндами унарных и бинарных операций.

\begin{Grammar}
Первичное-выражение
    : Операнд
	( Доступ
	| Индексация
	| Преобразование
	| Аргументы-вызова
	| Конструктор-массива
	| Конструктор-класса
	| Отмена-может-быть
	)*
\end{Grammar}    

\begin{Trivil}
1
к.поле
а[№]
Факториал(5)
А[1, 2, 3]
К{имя: "Вася", возраст: 23}
а^
объект.вектор[номер].метод()
\end{Trivil}

\hypertarget{operands}{%
\subsection{Операнды}\label{expr:operands}}

Операнды - это элементарные значения в выражении. Операнд может быть литералом, именем объекта, 
обозначающим константу, переменную или функцию, или выражением в скобках.

\begin{Grammar}
Операнд: Литерал | Имя-объекта | '(' Выражение ')'
Литерал
    : Целочисленный-литерал
    | Вещественный-литерал
    | Строковый-литерал
    | Символьный-литерал
Имя-объекта: Идентификатор | Импорт-идент
Импорт-идент: Идентификатор '.' Идентификатор
\end{Grammar}    

Если в качестве имени объекта используется \emph{Импорт-идент}, то первый идентификатор в нем должен обозначать имя импортированного модуля (\See{mods:import}), а второй идентификатор должен быть идентификатором экспортированного из этого модуля объекта.

\smallskip
\begin{tabular}[c]{l|l}
\textbf{Операнд} & \textbf{Тип выражения} \\ \hline
Имя объекта & тип объекта \\
Целочисленный-литерал & Цел64 \\
Вещественный-литерал & Вещ64 \\ 
Строковый-литерал & Строка \\ 
Символьный-литерал & Символ \\
Выражение в скобках & тип выражения \\
\end{tabular}

\hypertarget{selector}{%
\subsection{Доступ к полям и методам}\label{expr:selector}}

Доступ применяется к первичному выражению.

\begin{Grammar}
Доступ: '.' Идентификатор
\end{Grammar}    

В выражении \verb|что-то.имя|:
\begin{itemize}
\item
    \verb|что-то| должно быть выражением типа \emph{Т}, где \emph{Т} - это тип класса. 
\item
    а \verb|имя| должно быть идентификатором поля или метода типа \emph{Т} или базового класса \emph{Т}
\end{itemize}

Типом выражения доступа является тип поля или метода.

\begin{Trivil}
чел.возраст := 5

если чел.возраст < 18 { ... }
\end{Trivil}

\hypertarget{indexation}{%
\subsection{Индексация}\label{expr:indexation}}

Индексация применяется к первичному выражению.

\begin{Grammar}
Индексация: '[' Выражение '['
\end{Grammar}    

Выражении \verb|что-то[индекс]| обозначает элемент вектора или вариативного параметра, индекс которого определяется выражением \verb|индекс|.
\begin{itemize}
\item
    \verb|что-то| должно быть идентификатором, обозначающим вариативный параметр
\item
    или \verb|что-то| должно быть выражением типа \emph{Т}, где \emph{Т} - это тип вектора
\item
    \verb|индекс| должен быть выражением типа \verb|Цел64| или \verb|Байт|
\end{itemize}

Если во время исполнения индекс выходит за границы вектора или параметра (индекс < 0 | индекс >= длина), происходит \emph{авария}.

Типом выражения индексации является тип элемента вектора, если индексируется вектор или тип вариативного параметра, если индексируется вариативный параметр.

Так как индексация и конструктор вектора (\See{expr:vector-composite}) не всегда различимы синтаксически, выбор между ними происходит на уровне семантики, 
если выражение \verb|что-то|  обозначает тип, то это конструктор вектора, иначе индексация.

\hypertarget{conversion}{%
\subsection{Преобразование типа}\label{expr:conversion}}

Преобразование типа применяется к первичному выражению, и преобразует, если это возможно, значение выражения к \emph{целевому типу}, указанному в операции преобразования.
Если во время выполнения преобразования оказывается, что выполнить его нельзя, происходит \emph{авария}.

\begin{Grammar}
Преобразование: '(:' 'осторожно'? Указ-типа ')'
\end{Grammar}   

Если в преобразование есть ключевое слово \keyword{преобразование}, то это небезопасная операция, которая рассматривается отдельно (\See{unsafe:conversions}).






\hypertarget{call}{%
\subsection{Вызов функции или метода}\label{expr:call}}

\hypertarget{vector-composite}{%
\subsection{Конструктор вектора}\label{expr:vector-composite}}

\hypertarget{class-composite}{%
\subsection{Конструктор экземпляра класса}\label{expr:class-composite}}

\hypertarget{mb-ops}{%
\subsection{Операции для объектов может быть типа}\label{expr:mb-ops}}

\hypertarget{operators}{%
\subsection{Операции}\label{expr:operators}}

\hypertarget{const-expr}{%
\subsection{Константные выражения}\label{expr:const-expr}}