\hypertarget{lexica}{%
\section{Лексика}\label{lex:chapter}}

Исходный текст есть последовательность лексем: идентификаторов (\See{lex:idents}), ключевых слов (\See{lex:keywords}), 
знаков операций и знаков препинания (\See{lex:ops}), литералов (\See{lex:intlit}, \See{lex:floatlit}, \See{lex:strlit}, \See{lex:symlit}) и модификаторов (\See{lex:modifiers}). 
Каждая лексема состоит из последовательности Unicode символов (unicode code point) в кодировке UTF-8.

Пробелы (U+0020), символы табуляции (U+0009) и символы завершения строки (U+000D, U+000A) разделяют лексемы, и, игнорируются, кроме следующих случаев:
\begin{d_itemize}
\item
Символы завершения строк могут использоваться как разделители синтаксических конструкций (\See{lex:separators}).
\item
  Пробелы являются значащими символами в идентификаторах, состоящих из нескольких слов (\See{lex:idents}). 
\item
  Пробелы являются значащими в строковых и символьных литералах (\See{lex:idents}). 
\end{d_itemize}

Несколько разделителей трактуются, как один.

\bigskip
Исходный текст может содержать \emph{комментарии} (\See{lex:comments}).

\hypertarget{comments}{%
\subsection{Комментарии}\label{lex:comments}}

Есть две формы комментариев:
\begin{d_itemize}
\item
Строчный комментарий начинаeтся с последовательности символов '//' и заканчиваeтся в конце строки.
\item
Блочный комментарий начинается с последовательности символов '/*' и заканчивается последовательностью символов '*/'. 
Блочные комментарии могут быть вложенные.
\end{d_itemize}

\begin{Grammar}
Комментарий
    : '//' (любой символ, кроме завершения строки)*
    | '/*'  (любой символ)* '*/'
\end{Grammar}

\hypertarget{separators}{%
\subsection{Разделители синтаксических конструкций}\label{lex:separators}}

Некоторые синтаксические правила используют нетерминал \emph{Разделитель} для разделения двух подряд идущих синтаксических конструкций, например:
\begin{Grammar}
Список-операторов: Оператор (Разделитель Оператор)* 
\end{Grammar}

В качестве разделителя может использоваться символ ';' или символ завершения строки.
\begin{Grammar}
Разделитель: ';'  | символ-завершения-строки
\end{Grammar}

\begin{samepage}
Пример:
\begin{Trivil}[vspace=2pt]
а := 1; б := 2
в := 1 
\end{Trivil}
\end{samepage}

В строке 1 операторы разделены символом ';', а оператор в строке 2 отделен от операторов строки 1 символом завершения строки.

Ошибка компиляции - нет разделителя:
\begin{SampleErr}[vspace=2pt]
а := 1 б := 2
\end{SampleErr}

\hypertarget{idents}{%
\subsection{Идентификаторы}\label{lex:idents}}

Идентификатор - это последовательность \emph{Слов}, разделенных пробелами или символами дефис '-' с опционально завершающим знаком препинания:

Каждое слово состоит из \emph{Букв} и \emph{Цифр}, и начинается с Буквы. Буквой считается любой Unicode символ, имеющий признак \emph{Letter}, и, дополнительно, символы '№'
и '\_'. 

\begin{Grammar}
Идентификатор: Слово ((' ' | '-') Слово)* Знак-препинания?
Слово: Буква (Буква | Цифра)*
Буква: Unicode-letter | '_' | '№'
Цифра: '0' .. '9'
Знак-препинания: '?' | '!' 
\end{Grammar}

Примеры идентификаторов:
\begin{Trivil}[vspace=2pt]
буква
буква-или-цифра
№-символа
Цифра?
Пора паниковать!
\end{Trivil}

\hypertarget{keywords}{%
\subsection{Ключевые слова}\label{lex:keywords}}

Следующие ключевые слова зарезервированы и не могут быть использованы, как идентификаторы:

\begin{tabular}[c]{*{5}{p{2cm}}}
авария   & если     & конст    & пока          &  тип    \\
вернуть & иначе   & мб        &   прервать  &   типа    \\
вход      & импорт & модуль  &  пусть      &   фн     \\
выбор   & класс    & надо     &    позже     &   цикл     \\                                        
другое  & когда    & осторожно  & среди    &        \\
\end{tabular}

\hypertarget{ops}{%
\subsection{Знаки операций и знаки препинания}\label{lex:ops}}

Следующие последовательности символов обозначают знаки операций и знаки препинания:
% добавить bitop
\begin{Verbatim}
    +   -   *   /   %
    =   #   <   <=  >   >=
    &   |   ~
    :&  :|  :\  :~  <<  >>
    :=  ++  --
    (   )   [   ]   {   }
    (:  .   ^   ,   :   ;   
\end{Verbatim}

\hypertarget{intlit}{%
\subsection{Целочисленные литералы}\label{lex:intlit}}

\begin{Grammar}
Целочисленный-литерал: 
    Десятичный-литерал | Шестнадцатеричный-литерал
Десятичный-литерал: Цифра+  
Шестнадцатеричный-литерал: '0x' Цифра16+
Цифра16: '0'..'9' | 'a'..'f' | 'A'..'F'
\end{Grammar}    

Тип десятичного литерала: \verb+Цел64+, тип шестнадцатеричного литерала: \verb+Слово64+ (\See{decls:predefined-types}). 

\hypertarget{floatlit}{%
\subsection{Вещественные литералы}\label{lex:floatlit}}

В текущей реализации есть только одна форма записи вещественных литералов, без экспоненты.

\begin{Grammar}
Вещественный-литерал: Цифра+ '.' Цифра*
\end{Grammar}      

Тип вещественного литерала: \verb+Вещ64+ (\See{decls:predefined-types}). 

\hypertarget{strlit}{%
\subsection{Строковые литералы}\label{lex:strlit}}

Строковый литерал - это последовательность символов, заключенные в двойные кавычки. Строковый литерал может содержать символы, закодированные с помощью escape-последовательности, которая начинается с символа \verb+'\'+. Строковый литерал должен целиком находиться на одной строке текста.

\begin{Grammar}
Строковый-литерал
    : '"'
    (~('"' | '\\' | '\n' | '\r' | '\t') | Escape)* 
    '"' 
Escape
    : '\\'
    ( 'u' Цифра16 Цифра16 Цифра16 Цифра16
    | 'n' | 'r' | 't' 
    | '"'
    | "'"
    )
\end{Grammar}  

Тип строкового литерала: \verb+Строка+ (\See{decls:predefined-types}). 

\hypertarget{multistrlit}{%
\subsection{Многострочные литералы}\label{lex:multistrlit}}

Многострочный литерал - это последовательность символов, заключенные в обратные кавычки:  \verb+`Привет`+. 
Последовательность может содержать любой символ, кроме обратной кавычки.

\begin{Grammar}
Многострочный-литерал
    : '`' (~('`' )* '`' 
\end{Grammar}  

В многострочном литерале escape-последовательности не обрабатываются.
В частности, обратная косая черта не имеет выделенного значения и строка может содержать символ конца строка (\verb+\n+).
Последовательность \verb+\r\n+ заменяется на \verb+\n+, а одиночный символ \verb+\r+ игнорируется (не попадают в литерал).

\begin{Trivil}
`это длинный
многострочный литерал,
содержащий символы конца строки`
\end{Trivil}

Тип многострочного  литерала: \verb+Строка+ (\See{decls:predefined-types}). 

\hypertarget{symlit}{%
\subsection{Символьные литералы}\label{lex:symlit}}

Символьный литерал задает значение для Unicode code point, - это последовательность символов, заключенные в двойные кавычки.
Он записывается как один или несколько символов, заключенных в одинарные кавычки. Символьный литерал может быть закодирован с помощью escape-последовательности, которая начинается с символа \verb+'\'+.

\begin{Grammar}
Символьный-литерал
    : "'" 
    ~("'" | '\\' | '\n' | '\r' | '\t') | escape_value)
    "'"
\end{Grammar}  

Тип символьного литерала: \verb+Символ+ (\See{decls:predefined-types}). 

\hypertarget{modifiers}{%
\subsection{Модификаторы}\label{lex:modifiers}}

Модификаторы использутся в исходном тексте, чтобы внести изменение в в семантику и/или синтаксис конструкции языка, см., например, \See{decls:extern-fn}.

\begin{Grammar}
Модификатор: '@' Буква+ Cписок-атрибутов?
Cписок-атрибутов: '(' (Атрибут (',' Атрибут)*)? ')'
Атрибут: Строковый-литерал ': 'Строковый-литерал
\end{Grammar}  

\begin{Trivil}
@внеш("имя":"print_string")
\end{Trivil}